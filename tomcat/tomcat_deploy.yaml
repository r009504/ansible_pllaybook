---
  - name: Tomcat Deployment
    hosts: all
    become: yes
    tasks:
      - name: Install default java package
        package:
          name: "{{ java_package }}"
          state: present
      - name: Create tomcat group
        group:
          name: "{{ group_name }}"
          state: present
        notify:
          - group created
      - name: Create tomcat user
        user:
          name: "{{ user_name }}"
          group: "{{ group_name }}"
          shell: /bin/false
        notify:
          - user created
      - name: Create tomcat directory
        file:
          path: "{{ tomcat_dir }}"
          state: directory
      - name: Donwload tomcat binary 
        get_url:
          url: "{{ download_url }}"
          dest: "{{ download_location }}"
      - name: Extract the tar file and copy to /opt/tomcat
        shell:
          chdir: /tmp
          cmd: tar xzvf apache-tomcat-*tar.gz -C /opt/tomcat --strip-components=1

    handlers:
      - name: group created
        debug:
          msg: " {{ group_name }} created "

      - name:  user created
        debug:
          msg: " {{ user_name }} created "
          
